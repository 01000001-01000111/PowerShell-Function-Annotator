# PowerShell-Function-Annotator

PowerShell Function to add descriptive annotations to PowerShell script functions using the Google Cloud Generative AI (Gemini 1.5 Pro) API.

Created by Aric Galloso
3/26/2025

## Overview
This PowerShell function automates the process of adding descriptive annotations to other PowerShell script functions using the Google Cloud Generative AI (Gemini 1.5 Pro) API. 
It can process a single script or an entire directory of scripts, adding a comment block above each function definition with a concise description generated by the AI.

## Features
- Automated Function Annotation: Leverages the power of Gemini 1.5 Pro to understand and describe PowerShell functions.
- Single Script or Batch Processing: Can annotate a single PowerShell script file or all `.ps1` files within a specified directory (including subdirectories).
- Clear Annotation Format: Adds standard PowerShell comment blocks (`<# ... #>`) above each function, including a "Description" field.
- Path Handling: Robustly handles file and directory paths, including those with quotes.
- Error Handling: Includes error handling for API calls and file operations.
- Informative Output: Provides a summary of the annotation process, including the number of successful and failed scripts.
- Interactive Mode: Prompts the user for necessary information like API key, source, and destination paths.

## Software Installed
The function utilizes the Google Cloud Generative AI (Gemini 1.5 Pro) API.

## Requirements
- Windows
- PowerShell: This function is written in PowerShell and requires a compatible version to run.
- Google Cloud Generative AI API Key: You will need a valid API key to access the Gemini 1.5 Pro model. You can obtain this from the Google Cloud Console. Ensure the Generative Language API is enabled in your Google Cloud project.
- Network Connectivity: The script needs internet access to communicate with the Google Cloud API.

## Usage
To use the `Invoke-PowerShellScriptAnnotation` script:

1. Open PowerShell with administrative privileges
2. Navigate to the directory containing the script
3. Run the script:
   ```powershell
   .\Annotate-Scripts.ps1
